import{r as i}from"./index.BVOCwoKb.js";import{m}from"./matrixState.DeZ8y74b.js";var J={exports:{}},k={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var L;function I(){if(L)return k;L=1;var o=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function s(c,r,u){var l=null;if(u!==void 0&&(l=""+u),r.key!==void 0&&(l=""+r.key),"key"in r){u={};for(var h in r)h!=="key"&&(u[h]=r[h])}else u=r;return r=u.ref,{$$typeof:o,type:c,key:l,ref:r!==void 0?r:null,props:u}}return k.Fragment=e,k.jsx=s,k.jsxs=s,k}var A;function O(){return A||(A=1,J.exports=I()),J.exports}var a=O();const B=({panelActionLabel:o,setPanelActionLabel:e,dragMode:s,setDragMode:c,activateAll:r,deactivateAll:u,toggleModeLabels:l,downloadMatrix:h})=>a.jsxs("div",{className:"flex flex-col gap-4 border-l border-gray-400 h-fit relative",children:[a.jsx("span",{className:["absolute -top-2 text-xs -rotate-90 top-1/2 -left-6 w-0 h-0 flex flex-col items-center whitespace-nowrap text-md transition-all duration-300 ease-in-out",o?.content?o.color:"transparent"].join(" "),children:o?.content}),a.jsxs("div",{className:" flex flex-col gap-2 items-center border-r border-gray-400 h-fit px-2 relative",children:[a.jsx("button",{onClick:()=>c("toggle"),onMouseEnter:()=>e({content:"Alterna el estado de cada celda",color:"text-yellow-500"}),onMouseLeave:()=>e(null),className:`p-1 text-md font-medium transition-all cursor-pointer aspect-square w-8 h-8 ${s==="toggle"?"bg-gray-600 text-yellow-500 ":"text-gray-600 hover:bg-gray-200"}`,children:"◩"}),a.jsx("button",{onClick:()=>c("activate"),onMouseEnter:()=>e({content:"Siempre activa las celdas (pintar)",color:"text-green-500"}),onMouseLeave:()=>e(null),className:`p-1 text-md font-medium transition-all cursor-pointer aspect-square w-8 h-8 ${s==="activate"?"bg-gray-600 text-green-500 ":"text-gray-600 hover:bg-gray-200"}`,children:"▣"}),a.jsx("button",{onClick:()=>c("deactivate"),onMouseEnter:()=>e({content:"Siempre desactiva las celdas (borrar)",color:"text-red-500"}),onMouseLeave:()=>e(null),className:`p-1 text-md font-medium transition-all cursor-pointer aspect-square w-8 h-8 ${s==="deactivate"?"bg-gray-600 text-red-500 ":"text-gray-600 hover:bg-gray-200"}`,children:"☐"}),a.jsx("span",{className:["absolute -bottom-2 text-xs rotate-90 top-1/2 -right-6 w-0 h-0 flex flex-col items-center whitespace-nowrap text-md",s==="toggle"?"text-yellow-500 ":s==="activate"?"text-green-500 ":"text-red-500 "].join(" "),children:l[s]})]}),a.jsxs("div",{className:" flex flex-col gap-2 items-center border-r border-gray-400 h-fit px-2 relative",children:[a.jsx("button",{onClick:r,onMouseEnter:()=>e({content:"Seleccionar todas las celdas",color:"text-green-500"}),onMouseLeave:()=>e(null),className:"p-1 text-md font-medium transition-all cursor-pointer aspect-square w-8 h-8",children:"☑"}),a.jsx("button",{onClick:u,onMouseEnter:()=>e({content:"Limpiar todas las celdas",color:"text-red-500"}),onMouseLeave:()=>e(null),className:"p-1 text-md font-medium transition-all cursor-pointer aspect-square w-8 h-8",children:"☒"}),a.jsx("span",{className:["absolute  text-xs rotate-90 top-1/2 -right-6 w-0 h-0 flex flex-col items-center whitespace-nowrap text-md transition-all duration-200 ease-in-out"].join(" ")})]}),a.jsxs("div",{className:" flex flex-col gap-2 items-center border-r border-gray-400 h-fit px-2 relative",children:[a.jsx("button",{onClick:h,onMouseEnter:()=>e({content:"Descargar como archivo",color:"text-orange-500"}),onMouseLeave:()=>e(null),className:"p-1 text-md font-medium transition-all cursor-pointer aspect-square w-8 h-8",children:"▼"}),a.jsx("span",{className:["absolute text-green-500 text-xs top-1/4 -right-2 w-0 h-0 items-center whitespace-nowrap text-md transition-all duration-200 ease-in-out"].join(" "),children:"¡Descarga exitosa!"})]})]});function H(o,e,s){let c=new Set(e).add(void 0);return o.listen((r,u,l)=>{c.has(l)&&s(r,u,l)})}let _=(o,e)=>s=>{o.current!==s&&(o.current=s,e())};function U(o,{keys:e,deps:s=[o,e]}={}){let c=i.useRef();c.current=o.get();let r=i.useCallback(l=>(_(c,l)(o.value),e?.length>0?H(o,e,_(c,l)):o.listen(_(c,l))),s),u=()=>c.current;return i.useSyncExternalStore(r,u,u)}const Y=()=>{const[o,e]=i.useState(17),[s,c]=i.useState(11),[r,u]=i.useState(!1),[l,h]=i.useState("toggle"),[R,S]=i.useState(null);U(m);const w=i.useCallback((n,t,d=0)=>Array(n).fill(null).map(()=>Array(t).fill(d)),[]),N=i.useCallback(()=>{const n=w(o,s,0),t=m.get(),d=t.length,v=t[0]?.length||0,g=o-d;if(g>=0){const j=g;for(let x=0;x<d;x++)for(let f=0;f<Math.min(s,v);f++)if(t[x]&&t[x][f]!==void 0){const E=x+j;E<o&&(n[E][f]=t[x][f])}}else{const j=Math.abs(g);for(let x=j;x<d;x++)for(let f=0;f<Math.min(s,v);f++)if(t[x]&&t[x][f]!==void 0){const E=x-j;n[E][f]=t[x][f]}}m.set(n)},[o,s,m.get(),w]),D=i.useCallback(()=>{const n={toggle:"cursor-crosshair",activate:"cursor-copy",deactivate:"cursor-not-allowed"};return r?n[l]||"cursor-default":"cursor-pointer"},[r,l]),p=i.useCallback((n,t,d=null)=>{const g=m.get().map(j=>[...j]);d!==null?g[n][t]=d:g[n][t]=g[n][t]===0?1:0,m.set(g)},[r]),$=i.useCallback((n,t)=>{u(!0),{toggle:()=>p(n,t),activate:()=>p(n,t,1),deactivate:()=>p(n,t,0)}[l]()},[p,l]),q=i.useCallback((n,t)=>{r&&{toggle:()=>p(n,t),activate:()=>p(n,t,1),deactivate:()=>p(n,t,0)}[l]()},[r,p,l]),b=i.useCallback(()=>{u(!1)},[]),M=i.useCallback(n=>{r&&n.preventDefault()},[r]),y=i.useCallback(()=>{const t=m.get().map(d=>d.map(()=>1));m.set(t)},[]),T=i.useCallback(()=>{const t=m.get().map(d=>d.map(()=>0));m.set(t)},[]),C=i.useCallback(async()=>{const n=m.get(),t="matrix.json",d=new Blob([JSON.stringify(n,null,2)],{type:"application/json"});try{if(!window?.showSaveFilePicker){alert("Tu navegador no soporta la descarga avanzada. Usa Chrome o Edge.");return}const g=await(await window?.showSaveFilePicker({suggestedName:t,types:[{description:"Archivo JSON",accept:{"application/json":[".json"]}}]})).createWritable();await g.write(d),await g.close()}catch(v){v.name!=="AbortError"&&console.error("Error al guardar el archivo:",v)}},[]);return i.useEffect(()=>{N()},[o,s]),i.useEffect(()=>(document.addEventListener("mouseup",b),document.addEventListener("mousemove",M),()=>{document.removeEventListener("mouseup",b),document.removeEventListener("mousemove",M)}),[b,M]),{matrix:m,rows:o,setRows:e,cols:s,setCols:c,isDragging:r,dragMode:l,setDragMode:h,panelActionLabel:R,setPanelActionLabel:S,createMatrix:w,updateDimensions:N,getCursorClass:D,toggleCell:p,handleMouseDown:$,handleMouseEnter:q,handleMouseUp:b,handleMouseMove:M,activateAll:y,deactivateAll:T,toggleModeLabels:{toggle:"Intercambia",activate:"Activa",deactivate:"Desactiva"},downloadMatrix:C}},W=()=>{const{matrix:o,rows:e,setRows:s,cols:c,setCols:r,isDragging:u,dragMode:l,setDragMode:h,panelActionLabel:R,setPanelActionLabel:S,getCursorClass:w,handleMouseDown:N,handleMouseEnter:D,activateAll:p,deactivateAll:$,toggleModeLabels:q,downloadMatrix:b}=Y();return a.jsxs("div",{className:"flex p-10 gap-8 ",children:[a.jsxs("div",{className:"inline-block w-fit h-fit ",children:[a.jsxs("div",{className:`grid gap-[1px] mb-4 relative ${w()}`,style:{gridTemplateColumns:`repeat(${c}, 1fr)`,userSelect:"none"},children:[a.jsxs("div",{className:"w-[1px] h-full border-l-[1px] border-dashed border-gray-400 absolute -left-4 top-0 flex items-center",children:[a.jsx("button",{className:"absolute -top-2 -left-5 text-2xl font-thin text-gray-600",onClick:()=>{s(e+1)},children:"↑"}),a.jsxs("div",{className:" transform -rotate-90 translate-x-[-24px] whitespace-nowrap w-0 h-0 flex flex-col items-center",children:[e," filas"]}),a.jsx("button",{className:"absolute -bottom-2 -left-5 text-2xl font-thin text-gray-600",onClick:()=>{s(e-1)},children:"↓"})]}),o.get().map((M,y)=>M.map((T,C)=>a.jsx("button",{onMouseDown:()=>N(y,C),onMouseEnter:()=>D(y,C),onDragStart:F=>F.preventDefault(),className:`w-8 h-8 border-[1px] border-dotted border-gray-300 text-sm font-bold transition-all duration-200 hover:scale-110 ${T===1?"bg-gray-700 border-white":"hover:bg-gray-50"} ${u?"select-none":""} ${w()}`},`${y}-${C}`)))]}),a.jsxs("div",{className:"w-full h-[1px] border-t-[1px] border-dashed border-gray-400 relative",children:[a.jsx("button",{className:"absolute -top-2 left-0 text-3xl font-thin text-gray-600",onClick:()=>{r(c-1)},children:"←"}),a.jsxs("div",{className:" text-center",children:[c," columnas"]}),a.jsx("button",{className:"absolute -top-2 right-0 text-3xl font-thin text-gray-600",onClick:()=>{r(c+1)},children:"→"})]})]}),a.jsx(B,{panelActionLabel:R,setPanelActionLabel:S,dragMode:l,setDragMode:h,activateAll:p,deactivateAll:$,toggleModeLabels:q,downloadMatrix:b})]})};export{W as MatrixPanel};
